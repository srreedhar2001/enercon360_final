<!DOCTYPE html>
<html>
<head>
    <title>Debug Authentication</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow">
        <h2 class="text-xl font-bold mb-4">Authentication Debug</h2>
        
        <div class="space-y-4">
            <div>
                <h3 class="font-semibold text-gray-700">Current Auth Token:</h3>
                <div id="tokenStatus" class="p-3 bg-gray-100 rounded text-sm font-mono break-all"></div>
            </div>
            
            <div>
                <h3 class="font-semibold text-gray-700">User Data:</h3>
                <div id="userStatus" class="p-3 bg-gray-100 rounded text-sm font-mono"></div>
            </div>
            
            <div class="flex space-x-4">
                <button onclick="setToken()" class="bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">
                    Set Auth Token
                </button>
                <button onclick="clearToken()" class="bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700">
                    Clear Auth Token
                </button>
                <button onclick="checkToken()" class="bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700">
                    Check Token
                </button>
            </div>
            
            <div class="pt-4 border-t">
                <h3 class="font-semibold text-gray-700 mb-2">Quick Actions:</h3>
                <div class="space-x-2">
                    <a href="/user.html" class="inline-block bg-indigo-600 text-white py-2 px-4 rounded hover:bg-indigo-700">
                        Go to Users Page
                    </a>
                    <a href="/login.html" class="inline-block bg-gray-600 text-white py-2 px-4 rounded hover:bg-gray-700">
                        Go to Login
                    </a>
                </div>
            </div>
            
            <div id="result" class="hidden p-3 rounded"></div>
        </div>
    </div>

    <script>
        function setToken() {
            const testToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwibW9iaWxlIjoiOTcwMTUzMzM2MiIsIm5hbWUiOiJTcmlkaGFyIiwiZW1haWwiOiJzcnJlZWRoYXIyMDAxQGdtYWlsLmNvbSIsImlhdCI6MTc1NDI3NzY3NSwiZXhwIjoxNzU0MzY0MDc1fQ.-WAYJqW7bajlRDsRKt9v1ptf_8xAHxCQP40eXIy5cyc";
            const testUser = {
                id: 1,
                mobile: "9701533362",
                name: "Sridhar",
                email: "srreedhar2001@gmail.com"
            };
            
            localStorage.setItem('authToken', testToken);
            localStorage.setItem('userData', JSON.stringify(testUser));
            
            showResult('âœ… Auth token set successfully! Auto-redirecting to dashboard...', 'success');
            checkToken();
            
            // Auto-redirect to users dashboard
            setTimeout(() => {
                window.location.href = '/user.html';
            }, 2000);
        }
        
        function clearToken() {
            localStorage.removeItem('authToken');
            localStorage.removeItem('userData');
            
            showResult('ðŸ—‘ï¸ Auth token cleared!', 'warning');
            checkToken();
        }
        
        function checkToken() {
            const token = localStorage.getItem('authToken');
            const userData = localStorage.getItem('userData');
            
            document.getElementById('tokenStatus').textContent = token || 'No token found';
            document.getElementById('userStatus').textContent = userData || 'No user data found';
            
            if (token) {
                document.getElementById('tokenStatus').className = 'p-3 bg-green-100 rounded text-sm font-mono break-all text-green-800';
                document.getElementById('userStatus').className = 'p-3 bg-green-100 rounded text-sm font-mono text-green-800';
            } else {
                document.getElementById('tokenStatus').className = 'p-3 bg-red-100 rounded text-sm font-mono break-all text-red-800';
                document.getElementById('userStatus').className = 'p-3 bg-red-100 rounded text-sm font-mono text-red-800';
            }
        }
        
        function showResult(message, type) {
            const result = document.getElementById('result');
            result.textContent = message;
            result.className = `p-3 rounded ${type === 'success' ? 'bg-green-100 text-green-700' : 
                                            type === 'warning' ? 'bg-yellow-100 text-yellow-700' : 
                                            'bg-red-100 text-red-700'}`;
            result.classList.remove('hidden');
            
            setTimeout(() => {
                result.classList.add('hidden');
            }, 3000);
        }
        
        // Check token status when page loads
        document.addEventListener('DOMContentLoaded', checkToken);
    </script>
</body>
</html>
